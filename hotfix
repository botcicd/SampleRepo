this is a lot of code for the hotfix
